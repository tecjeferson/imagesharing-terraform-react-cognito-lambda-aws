"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Hash = void 0;
var util_buffer_from_1 = require("@aws-sdk/util-buffer-from");
var buffer_1 = require("buffer");
var crypto_1 = require("crypto");
var Hash = /** @class */ (function () {
    function Hash(algorithmIdentifier, secret) {
        this.hash = secret ? crypto_1.createHmac(algorithmIdentifier, castSourceData(secret)) : crypto_1.createHash(algorithmIdentifier);
    }
    Hash.prototype.update = function (toHash, encoding) {
        this.hash.update(castSourceData(toHash, encoding));
    };
    Hash.prototype.digest = function () {
        return Promise.resolve(this.hash.digest());
    };
    return Hash;
}());
exports.Hash = Hash;
function castSourceData(toCast, encoding) {
    if (buffer_1.Buffer.isBuffer(toCast)) {
        return toCast;
    }
    if (typeof toCast === "string") {
        return util_buffer_from_1.fromString(toCast, encoding);
    }
    if (ArrayBuffer.isView(toCast)) {
        return util_buffer_from_1.fromArrayBuffer(toCast.buffer, toCast.byteOffset, toCast.byteLength);
    }
    return util_buffer_from_1.fromArrayBuffer(toCast);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQ0EsOERBQXdGO0FBQ3hGLGlDQUFnQztBQUNoQyxpQ0FBd0U7QUFFeEU7SUFHRSxjQUFZLG1CQUEyQixFQUFFLE1BQW1CO1FBQzFELElBQUksQ0FBQyxJQUFJLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxtQkFBVSxDQUFDLG1CQUFtQixFQUFFLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxtQkFBVSxDQUFDLG1CQUFtQixDQUFDLENBQUM7SUFDakgsQ0FBQztJQUVELHFCQUFNLEdBQU4sVUFBTyxNQUFrQixFQUFFLFFBQXNDO1FBQy9ELElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQztJQUNyRCxDQUFDO0lBRUQscUJBQU0sR0FBTjtRQUNFLE9BQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUNILFdBQUM7QUFBRCxDQUFDLEFBZEQsSUFjQztBQWRZLG9CQUFJO0FBZ0JqQixTQUFTLGNBQWMsQ0FBQyxNQUFrQixFQUFFLFFBQXlCO0lBQ25FLElBQUksZUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsRUFBRTtRQUMzQixPQUFPLE1BQU0sQ0FBQztLQUNmO0lBRUQsSUFBSSxPQUFPLE1BQU0sS0FBSyxRQUFRLEVBQUU7UUFDOUIsT0FBTyw2QkFBVSxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQztLQUNyQztJQUVELElBQUksV0FBVyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRTtRQUM5QixPQUFPLGtDQUFlLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsVUFBVSxFQUFFLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztLQUM3RTtJQUVELE9BQU8sa0NBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUNqQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSGFzaCBhcyBJSGFzaCwgU291cmNlRGF0YSB9IGZyb20gXCJAYXdzLXNkay90eXBlc1wiO1xuaW1wb3J0IHsgZnJvbUFycmF5QnVmZmVyLCBmcm9tU3RyaW5nLCBTdHJpbmdFbmNvZGluZyB9IGZyb20gXCJAYXdzLXNkay91dGlsLWJ1ZmZlci1mcm9tXCI7XG5pbXBvcnQgeyBCdWZmZXIgfSBmcm9tIFwiYnVmZmVyXCI7XG5pbXBvcnQgeyBjcmVhdGVIYXNoLCBjcmVhdGVIbWFjLCBIYXNoIGFzIE5vZGVIYXNoLCBIbWFjIH0gZnJvbSBcImNyeXB0b1wiO1xuXG5leHBvcnQgY2xhc3MgSGFzaCBpbXBsZW1lbnRzIElIYXNoIHtcbiAgcHJpdmF0ZSByZWFkb25seSBoYXNoOiBOb2RlSGFzaCB8IEhtYWM7XG5cbiAgY29uc3RydWN0b3IoYWxnb3JpdGhtSWRlbnRpZmllcjogc3RyaW5nLCBzZWNyZXQ/OiBTb3VyY2VEYXRhKSB7XG4gICAgdGhpcy5oYXNoID0gc2VjcmV0ID8gY3JlYXRlSG1hYyhhbGdvcml0aG1JZGVudGlmaWVyLCBjYXN0U291cmNlRGF0YShzZWNyZXQpKSA6IGNyZWF0ZUhhc2goYWxnb3JpdGhtSWRlbnRpZmllcik7XG4gIH1cblxuICB1cGRhdGUodG9IYXNoOiBTb3VyY2VEYXRhLCBlbmNvZGluZz86IFwidXRmOFwiIHwgXCJhc2NpaVwiIHwgXCJsYXRpbjFcIik6IHZvaWQge1xuICAgIHRoaXMuaGFzaC51cGRhdGUoY2FzdFNvdXJjZURhdGEodG9IYXNoLCBlbmNvZGluZykpO1xuICB9XG5cbiAgZGlnZXN0KCk6IFByb21pc2U8VWludDhBcnJheT4ge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5oYXNoLmRpZ2VzdCgpKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjYXN0U291cmNlRGF0YSh0b0Nhc3Q6IFNvdXJjZURhdGEsIGVuY29kaW5nPzogU3RyaW5nRW5jb2RpbmcpOiBCdWZmZXIge1xuICBpZiAoQnVmZmVyLmlzQnVmZmVyKHRvQ2FzdCkpIHtcbiAgICByZXR1cm4gdG9DYXN0O1xuICB9XG5cbiAgaWYgKHR5cGVvZiB0b0Nhc3QgPT09IFwic3RyaW5nXCIpIHtcbiAgICByZXR1cm4gZnJvbVN0cmluZyh0b0Nhc3QsIGVuY29kaW5nKTtcbiAgfVxuXG4gIGlmIChBcnJheUJ1ZmZlci5pc1ZpZXcodG9DYXN0KSkge1xuICAgIHJldHVybiBmcm9tQXJyYXlCdWZmZXIodG9DYXN0LmJ1ZmZlciwgdG9DYXN0LmJ5dGVPZmZzZXQsIHRvQ2FzdC5ieXRlTGVuZ3RoKTtcbiAgfVxuXG4gIHJldHVybiBmcm9tQXJyYXlCdWZmZXIodG9DYXN0KTtcbn1cbiJdfQ==